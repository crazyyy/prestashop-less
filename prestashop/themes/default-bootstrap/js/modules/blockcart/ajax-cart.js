function HoverWatcher(t){this.hovering=!1;var a=this;this.isHoveringOver=function(){return a.hovering},$(t).hover(function(){a.hovering=!0},function(){a.hovering=!1})}function crossselling_serialScroll(){$.prototype.bxSlider&&$("#blockcart_caroucel").bxSlider({minSlides:2,maxSlides:4,slideWidth:178,slideMargin:20,moveSlides:1,infiniteLoop:!1,hideControlOnEnd:!0,pager:!1})}$(document).ready(function(){ajaxCart.overrideButtonsInThePage(),$(document).on("click",".block_cart_collapse",function(t){t.preventDefault(),ajaxCart.collapse()}),$(document).on("click",".block_cart_expand",function(t){t.preventDefault(),ajaxCart.expand()});var t=0,a=parseInt((new Date).getTime()/1e3);"undefined"==typeof $(".ajax_cart_quantity").html()||"undefined"!=typeof generated_date&&null!=generated_date&&parseInt(generated_date)+30<a?ajaxCart.refresh():t=parseInt($(".ajax_cart_quantity").html());var o=new HoverWatcher("#header .cart_block"),i=new HoverWatcher("#header .shopping_cart");"ontouchstart"in document.documentElement&&$(".shopping_cart > a:first").on("click",function(t){t.preventDefault()}),$(document).on("touchstart","#header .shopping_cart a:first",function(){$(this).next(".cart_block:visible").length?$("#header .cart_block").stop(!0,!0).slideUp(450):$("#header .cart_block").stop(!0,!0).slideDown(450),e.preventDefault(),e.stopPropagation()}),$("#header .shopping_cart a:first").hover(function(){(ajaxCart.nb_total_products>0||t>0)&&$("#header .cart_block").stop(!0,!0).slideDown(450)},function(){setTimeout(function(){i.isHoveringOver()||o.isHoveringOver()||$("#header .cart_block").stop(!0,!0).slideUp(450)},200)}),$("#header .cart_block").hover(function(){},function(){setTimeout(function(){i.isHoveringOver()||$("#header .cart_block").stop(!0,!0).slideUp(450)},200)}),$(document).on("click",".delete_voucher",function(t){t.preventDefault(),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},async:!0,cache:!1,url:$(this).attr("href")+"?rand="+(new Date).getTime()}),$(this).parent().parent().remove(),("order"==$("body").attr("id")||"order-opc"==$("body").attr("id"))&&("undefined"!=typeof updateAddressSelection?updateAddressSelection():location.reload())}),$(document).on("click","#cart_navigation input",function(t){$(this).prop("disabled","disabled").addClass("disabled"),$(this).closest("form").get(0).submit()}),$(document).on("click","#layer_cart .cross, #layer_cart .continue, .layer_cart_overlay",function(t){t.preventDefault(),$(".layer_cart_overlay").hide(),$("#layer_cart").fadeOut("fast")}),$("#columns #layer_cart, #columns .layer_cart_overlay").detach().prependTo("#columns")});var ajaxCart={nb_total_products:0,overrideButtonsInThePage:function(){$(document).on("click",".ajax_add_to_cart_button",function(t){t.preventDefault();var a=$(this).data("id-product");"disabled"!=$(this).prop("disabled")&&ajaxCart.add(a,null,!1,this)}),$(document).on("click","#add_to_cart button",function(t){t.preventDefault(),ajaxCart.add($("#product_page_product_id").val(),$("#idCombination").val(),!0,null,$("#quantity_wanted").val(),null)}),$(document).on("click",".cart_block_list .ajax_cart_block_remove_link",function(t){t.preventDefault();var a=0,e=0,o=0,i=$($(this).parent().parent()).find("div[data-id^=deleteCustomizableProduct_]"),r=!1;if(i&&$(i).length){var n=i.data("id").split("_");"undefined"!=typeof n[1]&&(a=parseInt(n[1]),e=parseInt(n[2]),"undefined"!=typeof n[3]&&(o=parseInt(n[3])),"undefined"!=typeof n[4]&&(r=parseInt(n[4])))}if(!a){var s=$(this).parent().parent().data("id").replace("cart_block_product_","");s=s.replace("deleteCustomizableProduct_",""),n=s.split("_"),e=parseInt(n[0]),"undefined"!=typeof n[1]&&(o=parseInt(n[1])),"undefined"!=typeof n[2]&&(r=parseInt(n[2]))}ajaxCart.remove(e,o,a,r)})},expand:function(){$(".cart_block_list").hasClass("collapsed")&&($(".cart_block_list.collapsed").slideDown({duration:450,complete:function(){$(this).addClass("expanded").removeClass("collapsed")}}),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseDir+"modules/blockcart/blockcart-set-collapse.php?rand="+(new Date).getTime(),async:!0,cache:!1,data:"ajax_blockcart_display=expand",complete:function(){$(".block_cart_expand").fadeOut("fast",function(){$(".block_cart_collapse").fadeIn("fast")})}}))},collapse:function(){$(".cart_block_list").hasClass("expanded")&&($(".cart_block_list.expanded").slideUp("slow",function(){$(this).addClass("collapsed").removeClass("expanded")}),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseDir+"modules/blockcart/blockcart-set-collapse.php?rand="+(new Date).getTime(),async:!0,cache:!1,data:"ajax_blockcart_display=collapse&rand="+(new Date).getTime(),complete:function(){$(".block_cart_collapse").fadeOut("fast",function(){$(".block_cart_expand").fadeIn("fast")})}}))},refresh:function(){$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseUri+"?rand="+(new Date).getTime(),async:!0,cache:!1,dataType:"json",data:"controller=cart&ajax=true&token="+static_token,success:function(t){ajaxCart.updateCart(t)}})},updateCartInformation:function(t,a){ajaxCart.updateCart(t),a?($("#add_to_cart button").removeProp("disabled").removeClass("disabled"),t.hasError&&0!=t.hasError?$("#add_to_cart button").removeClass("added"):$("#add_to_cart button").addClass("added")):$(".ajax_add_to_cart_button").removeProp("disabled")},updateFancyBox:function(){},add:function(t,a,e,o,i,r){if(e&&!checkCustomizations()){if(contentOnly){var n=window.document.location.href+"",s=n.replace("content_only=1","");return void(window.parent.document.location.href=s)}return void($.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+fieldRequired+"</p>"}],{padding:0}):alert(fieldRequired))}emptyCustomizations(),e?($("#add_to_cart button").prop("disabled","disabled").addClass("disabled"),$(".filled").removeClass("filled")):$(o).prop("disabled","disabled"),$(".cart_block_list").hasClass("collapsed")&&this.expand(),$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseUri+"?rand="+(new Date).getTime(),async:!0,cache:!1,dataType:"json",data:"controller=cart&add=1&ajax=true&qty="+(i&&null!=i?i:"1")+"&id_product="+t+"&token="+static_token+(parseInt(a)&&null!=a?"&ipa="+parseInt(a):""),success:function(i,n,s){r&&!i.errors&&WishlistAddProductCart(r[0],t,a,r[1]),i.hasError?(contentOnly?window.parent.ajaxCart.updateCart(i):ajaxCart.updateCart(i),e?$("#add_to_cart button").removeProp("disabled").removeClass("disabled"):$(o).removeProp("disabled")):(contentOnly?window.parent.ajaxCart.updateCartInformation(i,e):ajaxCart.updateCartInformation(i,e),i.crossSelling&&$(".crossseling").html(i.crossSelling),a?$(i.products).each(function(){void 0!=this.id&&this.id==parseInt(t)&&this.idCombination==parseInt(a)&&(contentOnly?window.parent.ajaxCart.updateLayer(this):ajaxCart.updateLayer(this))}):$(i.products).each(function(){void 0!=this.id&&this.id==parseInt(t)&&(contentOnly?window.parent.ajaxCart.updateLayer(this):ajaxCart.updateLayer(this))}),contentOnly&&parent.$.fancybox.close())},error:function(t,a,i){var r="Impossible to add the product to the cart.<br/>textStatus: '"+a+"'<br/>errorThrown: '"+i+"'<br/>responseText:<br/>"+t.responseText;$.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+r+"</p>"}],{padding:0}):alert(r),e?$("#add_to_cart button").removeProp("disabled").removeClass("disabled"):$(o).removeProp("disabled")}})},remove:function(t,a,e,o){$.ajax({type:"POST",headers:{"cache-control":"no-cache"},url:baseUri+"?rand="+(new Date).getTime(),async:!0,cache:!1,dataType:"json",data:"controller=cart&delete=1&id_product="+t+"&ipa="+(null!=a&&parseInt(a)?a:"")+(e&&null!=e?"&id_customization="+e:"")+"&id_address_delivery="+o+"&token="+static_token+"&ajax=true",success:function(i){ajaxCart.updateCart(i),("order"==$("body").attr("id")||"order-opc"==$("body").attr("id"))&&deleteProductFromSummary(t+"_"+a+"_"+e+"_"+o)},error:function(){var t="ERROR: unable to delete the product";$.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:t}],{padding:0}):alert(t)}})},hideOldProducts:function(t){if($(".cart_block_list:first dl.products").length>0){var a=null;$(".cart_block_list:first dl.products dt").each(function(){var e=$(this).data("id"),o=e.replace("cart_block_product_",""),i=o.split("_"),r=!1;for(aProduct in t.products)t.products[aProduct].id!=i[0]||i[1]&&t.products[aProduct].idCombination!=i[1]||(r=!0,ajaxCart.hideOldProductCustomizations(t.products[aProduct],e));if(!r&&(a=$(this).data("id"),null!=a)){var o=a.replace("cart_block_product_",""),i=o.split("_");$('dt[data-id="'+a+'"]').addClass("strike").fadeTo("slow",0,function(){$(this).slideUp("slow",function(){$(this).remove(),0==$(".cart_block:first dl.products dt").length&&($("#header .cart_block").stop(!0,!0).slideUp(200),$(".cart_block_no_products:hidden").slideDown(450),$(".cart_block dl.products").remove())})}),$('dd[data-id="cart_block_combination_of_'+i[0]+(i[1]?"_"+i[1]:"")+(i[2]?"_"+i[2]:"")+'"]').fadeTo("fast",0,function(){$(this).slideUp("fast",function(){$(this).remove()})})}})}},hideOldProductCustomizations:function(t,a){var e=$('ul[data-id="customization_'+t.id+"_"+t.idCombination+'"]');e.length>0&&$(e).find("li").each(function(){$(this).find("div").each(function(){var a=$(this).data("id"),e=a.replace("deleteCustomizableProduct_",""),o=e.split("_");parseInt(t.idCombination)!=parseInt(o[2])||ajaxCart.doesCustomizationStillExist(t,o[0])||$('div[data-id="'+a+'"]').parent().addClass("strike").fadeTo("slow",0,function(){$(this).slideUp("slow"),$(this).remove()})})});var o=$('.deleteCustomizableProduct[data-id="'+a+'"]').find(".ajax_cart_block_remove_link");t.hasCustomizedDatas||o.length||$('div[data-id="'+a+'"] span.remove_link').html('<a class="ajax_cart_block_remove_link" rel="nofollow" href="'+baseUri+"?controller=cart&amp;delete=1&amp;id_product="+t.id+"&amp;ipa="+t.idCombination+"&amp;token="+static_token+'"> </a>'),t.is_gift&&$('div[data-id="'+a+'"] span.remove_link').html("")},doesCustomizationStillExist:function(t,a){var e=!1;return $(t.customizedDatas).each(function(){return this.customizationId==a?(e=!0,!1):void 0}),e},refreshVouchers:function(t){if("undefined"==typeof t.discounts||0==t.discounts.length)$(".vouchers").hide();else{for($(".vouchers tbody").html(""),i=0;i<t.discounts.length;i++)if(parseFloat(t.discounts[i].price_float)>0){var a="";t.discounts[i].code.length&&(a='<a class="delete_voucher" href="'+t.discounts[i].link+'" title="'+delete_txt+'"><i class="icon-remove-sign"></i></a>'),$(".vouchers tbody").append($('<tr class="bloc_cart_voucher" data-id="bloc_cart_voucher_'+t.discounts[i].id+'">	<td class="quantity">1x</td>	<td class="name" title="'+t.discounts[i].description+'">'+t.discounts[i].name+'</td>	<td class="price">-'+t.discounts[i].price+'</td>	<td class="delete">'+a+"</td></tr>"))}$(".vouchers").show()}},updateProductQuantity:function(t,a){$("dt[data-id=cart_block_product_"+t.id+"_"+(t.idCombination?t.idCombination:"0")+"_"+(t.idAddressDelivery?t.idAddressDelivery:"0")+"] .quantity").fadeTo("fast",0,function(){$(this).text(a),$(this).fadeTo("fast",1,function(){$(this).fadeTo("fast",0,function(){$(this).fadeTo("fast",1,function(){$(this).fadeTo("fast",0,function(){$(this).fadeTo("fast",1)})})})})})},displayNewProducts:function(t){$(t.products).each(function(){if(void 0!=this.id){0==$(".cart_block:first dl.products").length&&($(".cart_block_no_products").before('<dl class="products"></dl>'),$(".cart_block_no_products").hide());var t=this.id+"_"+(this.idCombination?this.idCombination:"0")+"_"+(this.idAddressDelivery?this.idAddressDelivery:"0"),a=this.id+"_"+(this.idCombination?this.idCombination:"0");if(0==$('dt[data-id="cart_block_product_'+t+'"]').length){var e=parseInt(this.id),o=(this.hasAttributes?parseInt(this.attributes):0,'<dt class="unvisible" data-id="cart_block_product_'+t+'">'),i=$.trim($("<span />").html(this.name).text());i=i.length>12?i.substring(0,10)+"...":i,o+='<a class="cart-images" href="'+this.link+'" title="'+i+'"><img  src="'+this.image_cart+'" alt="'+this.name+'"></a>',o+='<div class="cart-info"><div class="product-name"><span class="quantity-formated"><span class="quantity">'+this.quantity+'</span>&nbsp;x&nbsp;</span><a href="'+this.link+'" title="'+this.name+'" class="cart_block_product_name">'+i+"</a></div>",this.hasAttributes&&(o+='<div class="product-atributes"><a href="'+this.link+'" title="'+this.name+'">'+this.attributes+"</a></div>"),"undefined"!=typeof freeProductTranslation&&(o+='<span class="price">'+(parseFloat(this.price_float)>0?this.priceByLine:freeProductTranslation)+"</span></div>"),o+="undefined"==typeof this.is_gift||0==this.is_gift?'<span class="remove_link"><a rel="nofollow" class="ajax_cart_block_remove_link" href="'+baseUri+"?controller=cart&amp;delete=1&amp;id_product="+e+"&amp;token="+static_token+(this.hasAttributes?"&amp;ipa="+parseInt(this.idCombination):"")+'"> </a></span>':'<span class="remove_link"></span>',o+="</dt>",this.hasAttributes&&(o+='<dd data-id="cart_block_combination_of_'+t+'" class="unvisible">'),this.hasCustomizedDatas&&(o+=ajaxCart.displayNewCustomizedDatas(this)),this.hasAttributes&&(o+="</dd>"),$(".cart_block dl.products").append(o)}else{var r=this;($.trim($('dt[data-id="cart_block_product_'+t+'"] .quantity').html())!=r.quantity||$.trim($('dt[data-id="cart_block_product_'+t+'"] .price').html())!=r.priceByLine)&&(this.is_gift?$('dt[data-id="cart_block_product_'+t+'"] .price').html(freeProductTranslation):$('dt[data-id="cart_block_product_'+t+'"] .price').text(r.priceByLine),ajaxCart.updateProductQuantity(r,r.quantity),r.hasCustomizedDatas&&(customizationFormatedDatas=ajaxCart.displayNewCustomizedDatas(r),$('ul[data-id="customization_'+a+'"]').length?($('ul[data-id="customization_'+a+'"]').html(""),$('ul[data-id="customization_'+a+'"]').append(customizationFormatedDatas)):r.hasAttributes?$('dd[data-id="cart_block_combination_of_'+t+'"]').append(customizationFormatedDatas):$(".cart_block dl.products").append(customizationFormatedDatas)))}$(".cart_block dl.products .unvisible").slideDown(450).removeClass("unvisible");var n=$('dt[data-id="cart_block_product_'+t+'"]').find("a.ajax_cart_block_remove_link");this.hasCustomizedDatas&&n.length&&$(n).each(function(){$(this).remove()})}})},displayNewCustomizedDatas:function(t){var a="",e=parseInt(t.id),o="undefined"==typeof t.idCombination?0:parseInt(t.idCombination),i=$('ul[data-id="customization_'+e+"_"+o+'"]').length;return i||(t.hasAttributes||(a+='<dd data-id="cart_block_combination_of_'+e+'" class="unvisible">'),void 0==$('ul[data-id="customization_'+e+"_"+o+'"]').val()&&(a+='<ul class="cart_block_customizations" data-id="customization_'+e+"_"+o+'">')),$(t.customizedDatas).each(function(){var r=0;customizationId=parseInt(this.customizationId),o="undefined"==typeof t.idCombination?0:parseInt(t.idCombination),a+='<li name="customization"><div class="deleteCustomizableProduct" data-id="deleteCustomizableProduct_'+customizationId+"_"+e+"_"+(o?o:"0")+'"><a rel="nofollow" class="ajax_cart_block_remove_link" href="'+baseUri+"?controller=cart&amp;delete=1&amp;id_product="+e+"&amp;ipa="+o+"&amp;id_customization="+customizationId+"&amp;token="+static_token+'"></a></div>',$(this.datas).each(function(){this.type==CUSTOMIZE_TEXTFIELD&&$(this.datas).each(function(){return 0==this.index?(a+=" "+this.truncatedValue.replace(/<br \/>/g," "),r=1,!1):void 0})}),r||(a+=customizationIdMessage+customizationId),i||(a+="</li>"),customizationId&&($("#uploadable_files li div.customizationUploadBrowse img").remove(),$("#text_fields input").attr("value",""))}),i||(a+="</ul>",t.hasAttributes||(a+="</dd>")),a},updateLayer:function(t){$("#layer_cart_product_title").text(t.name),$("#layer_cart_product_attributes").text(""),t.hasAttributes&&1==t.hasAttributes&&$("#layer_cart_product_attributes").html(t.attributes),$("#layer_cart_product_price").text(t.price),$("#layer_cart_product_quantity").text(t.quantity),$(".layer_cart_img").html('<img class="layer_cart_img img-responsive" src="'+t.image+'" alt="'+t.name+'" title="'+t.name+'" />');var a=parseInt($(window).scrollTop())+"px";$(".layer_cart_overlay").css("width","100%"),$(".layer_cart_overlay").css("height","100%"),$(".layer_cart_overlay").show(),$("#layer_cart").css({top:a}).fadeIn("fast"),crossselling_serialScroll()},updateCart:function(t){if(t.hasError){var a="";for(error in t.errors)"indexOf"!=error&&(a+=$("<div />").html(t.errors[error]).text()+"\n");$.prototype.fancybox?$.fancybox.open([{type:"inline",autoScale:!0,minHeight:30,content:'<p class="fancybox-error">'+a+"</p>"}],{padding:0}):alert(a)}else ajaxCart.updateCartEverywhere(t),ajaxCart.hideOldProducts(t),ajaxCart.displayNewProducts(t),ajaxCart.refreshVouchers(t),$(".cart_block .products dt").removeClass("first_item").removeClass("last_item").removeClass("item"),$(".cart_block .products dt:first").addClass("first_item"),$(".cart_block .products dt:not(:first,:last)").addClass("item"),$(".cart_block .products dt:last").addClass("last_item")},updateCartEverywhere:function(t){$(".ajax_cart_total").text($.trim(t.productTotal)),parseFloat(t.shippingCostFloat)>0?$(".ajax_cart_shipping_cost").text(t.shippingCost):"undefined"!=typeof freeShippingTranslation&&$(".ajax_cart_shipping_cost").html(freeShippingTranslation),$(".ajax_cart_tax_cost").text(t.taxCost),$(".cart_block_wrapping_cost").text(t.wrappingCost),$(".ajax_block_cart_total").text(t.total),$(".ajax_block_products_total").text(t.productTotal),$(".ajax_total_price_wt").text(t.total_price_wt),parseFloat(t.freeShippingFloat)>0?($(".ajax_cart_free_shipping").html(t.freeShipping),$(".freeshipping").fadeIn(0)):0==parseFloat(t.freeShippingFloat)&&$(".freeshipping").fadeOut(0),this.nb_total_products=t.nbTotalProducts,parseInt(t.nbTotalProducts)>0?($(".ajax_cart_no_product").hide(),$(".ajax_cart_quantity").text(t.nbTotalProducts),$(".ajax_cart_quantity").fadeIn("slow"),$(".ajax_cart_total").fadeIn("slow"),parseInt(t.nbTotalProducts)>1?($(".ajax_cart_product_txt").each(function(){$(this).hide()}),$(".ajax_cart_product_txt_s").each(function(){$(this).show()})):($(".ajax_cart_product_txt").each(function(){$(this).show()}),$(".ajax_cart_product_txt_s").each(function(){$(this).hide()}))):($(".ajax_cart_quantity, .ajax_cart_product_txt_s, .ajax_cart_product_txt, .ajax_cart_total").each(function(){$(this).hide()}),$(".ajax_cart_no_product").show("slow"))}};